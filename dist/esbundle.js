var $t=Object.create,ge=Object.defineProperty,Ft=Object.getPrototypeOf,Dt=Object.prototype.hasOwnProperty,Rt=Object.getOwnPropertyNames,kt=Object.getOwnPropertyDescriptor,G=Object.assign,Tt=e=>ge(e,"__esModule",{value:!0}),le=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports),At=(e,t,r)=>{if(Tt(e),t&&typeof t=="object"||typeof t=="function")for(let n of Rt(t))!Dt.call(e,n)&&n!=="default"&&ge(e,n,{get:()=>t[n],enumerable:!(r=kt(t,n))||r.enumerable});return e},z=e=>e&&e.__esModule?e:At(ge(e!=null?$t(Ft(e)):{},"default",{value:e,enumerable:!0}),e),Qe=le(Ne=>{var Ie=Object.defineProperty,_t=e=>Ie(e,"__esModule",{value:!0}),Ct=(e,t)=>{_t(e);for(var r in t)Ie(e,r,{get:t[r],enumerable:!0})},Le=(e,t,r)=>new Promise((n,i)=>{var a=u=>{try{o(r.next(u))}catch(p){i(p)}},l=u=>{try{o(r.throw(u))}catch(p){i(p)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(a,l);o((r=r.apply(e,t)).next())});Ct(Ne,{build:()=>Pt,buildSync:()=>It,serve:()=>Bt,startService:()=>oe,transform:()=>Nt,transformSync:()=>Lt,version:()=>Ot});function Me(e){let t=n=>{if(n===null)r.write8(0);else if(typeof n=="boolean")r.write8(1),r.write8(+n);else if(typeof n=="number")r.write8(2),r.write32(n|0);else if(typeof n=="string")r.write8(3),r.write(X(n));else if(n instanceof Uint8Array)r.write8(4),r.write(n);else if(n instanceof Array){r.write8(5),r.write32(n.length);for(let i of n)t(i)}else{let i=Object.keys(n);r.write8(6),r.write32(i.length);for(let a of i)r.write(X(a)),t(n[a])}},r=new Ue;return r.write32(0),r.write32(e.id<<1|+!e.isRequest),t(e.value),ye(r.buf,r.len-4,0),r.buf.subarray(0,r.len)}function Ut(e){let t=()=>{switch(r.read8()){case 0:return null;case 1:return!!r.read8();case 2:return r.read32();case 3:return Q(r.read());case 4:return r.read();case 5:{let l=r.read32(),o=[];for(let u=0;u<l;u++)o.push(t());return o}case 6:{let l=r.read32(),o={};for(let u=0;u<l;u++)o[Q(r.read())]=t();return o}default:throw new Error("Invalid packet")}},r=new Ue(e),n=r.read32(),i=(n&1)===0;n>>>=1;let a=t();if(r.ptr!==e.length)throw new Error("Invalid packet");return{id:n,isRequest:i,value:a}}var Ue=class{constructor(e=new Uint8Array(1024)){this.buf=e,this.len=0,this.ptr=0}_write(e){if(this.len+e>this.buf.length){let t=new Uint8Array((this.len+e)*2);t.set(this.buf),this.buf=t}return this.len+=e,this.len-e}write8(e){let t=this._write(1);this.buf[t]=e}write32(e){let t=this._write(4);ye(this.buf,e,t)}write(e){let t=this._write(4+e.length);ye(this.buf,e.length,t),this.buf.set(e,t+4)}_read(e){if(this.ptr+e>this.buf.length)throw new Error("Invalid packet");return this.ptr+=e,this.ptr-e}read8(){return this.buf[this._read(1)]}read32(){return We(this.buf,this._read(4))}read(){let e=this.read32(),t=new Uint8Array(e),r=this._read(t.length);return t.set(this.buf.subarray(r,r+e)),t}},X,Q;if(typeof TextEncoder!="undefined"&&typeof TextDecoder!="undefined"){let e=new TextEncoder,t=new TextDecoder;X=r=>e.encode(r),Q=r=>t.decode(r)}else if(typeof Buffer!="undefined")X=e=>Buffer.from(e),Q=e=>Buffer.from(e).toString();else throw new Error("No UTF-8 codec found");function We(e,t){return e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24}function ye(e,t,r){e[r++]=t,e[r++]=t>>8,e[r++]=t>>16,e[r++]=t>>24}function qe(e){if(e+="",e.indexOf(",")>=0)throw new Error(`Invalid target: ${e}`);return e}var I=e=>typeof e=="boolean"?null:"a boolean",g=e=>typeof e=="string"?null:"a string",Ve=e=>e instanceof RegExp?null:"a RegExp object",Y=e=>typeof e=="number"&&e===(e|0)?null:"an integer",Mt=e=>typeof e=="function"?null:"a function",L=e=>Array.isArray(e)?null:"an array",ae=e=>typeof e=="object"&&e!==null&&!Array.isArray(e)?null:"an object",Wt=e=>typeof e=="object"&&!Array.isArray(e)?null:"an object or null",be=e=>typeof e=="string"||typeof e=="boolean"?null:"a string or a boolean",qt=e=>typeof e=="string"||typeof e=="object"&&e!==null&&!Array.isArray(e)?null:"a string or an object",Vt=e=>typeof e=="string"||Array.isArray(e)?null:"a string or an array",Ht=e=>typeof e=="string"||e instanceof Uint8Array?null:"a string or a Uint8Array";function s(e,t,r,n){let i=e[r];if(t[r+""]=!0,i===void 0)return;let a=n(i);if(a!==null)throw new Error(`"${r}" must be ${a}`);return i}function U(e,t){for(let r in e)if(!(r in t))throw new Error(`Invalid option: "${r}"`)}function se(e,t,r,n,i){let a=s(t,r,"color",I),l=s(t,r,"logLevel",g),o=s(t,r,"errorLimit",Y);a?e.push(`--color=${a}`):n&&e.push("--color=true"),e.push(`--log-level=${l||i}`),e.push(`--error-limit=${o||0}`)}function He(e,t,r){let n=s(t,r,"target",Vt),i=s(t,r,"format",g),a=s(t,r,"globalName",g),l=s(t,r,"minify",I),o=s(t,r,"minifySyntax",I),u=s(t,r,"minifyWhitespace",I),p=s(t,r,"minifyIdentifiers",I),E=s(t,r,"charset",g),S=s(t,r,"treeShaking",be),b=s(t,r,"jsxFactory",g),D=s(t,r,"jsxFragment",g),B=s(t,r,"define",ae),W=s(t,r,"pure",L),H=s(t,r,"avoidTDZ",I),J=s(t,r,"keepNames",I),V=s(t,r,"banner",g),m=s(t,r,"footer",g);if(n&&(Array.isArray(n)?e.push(`--target=${Array.from(n).map(qe).join(",")}`):e.push(`--target=${qe(n)}`)),i&&e.push(`--format=${i}`),a&&e.push(`--global-name=${a}`),l&&e.push("--minify"),o&&e.push("--minify-syntax"),u&&e.push("--minify-whitespace"),p&&e.push("--minify-identifiers"),E&&e.push(`--charset=${E}`),S!==void 0&&S!==!0&&e.push(`--tree-shaking=${S}`),b&&e.push(`--jsx-factory=${b}`),D&&e.push(`--jsx-fragment=${D}`),B)for(let c in B){if(c.indexOf("=")>=0)throw new Error(`Invalid define: ${c}`);e.push(`--define:${c}=${B[c]}`)}if(W)for(let c of W)e.push(`--pure:${c}`);H&&e.push("--avoid-tdz"),J&&e.push("--keep-names"),V&&e.push(`--banner=${V}`),m&&e.push(`--footer=${m}`)}function Jt(e,t,r){let n=[],i=Object.create(null),a=null,l=null;se(n,e,i,t,r),He(n,e,i);let o=s(e,i,"sourcemap",be),u=s(e,i,"bundle",I),p=s(e,i,"splitting",I),E=s(e,i,"metafile",g),S=s(e,i,"outfile",g),b=s(e,i,"outdir",g),D=s(e,i,"outbase",g),B=s(e,i,"platform",g),W=s(e,i,"tsconfig",g),H=s(e,i,"resolveExtensions",L),J=s(e,i,"mainFields",L),V=s(e,i,"external",L),m=s(e,i,"loader",ae),c=s(e,i,"outExtension",ae),f=s(e,i,"publicPath",g),$=s(e,i,"inject",L),_=s(e,i,"entryPoints",L),k=s(e,i,"stdin",ae),C=s(e,i,"write",I)!==!1,x=s(e,i,"incremental",I)===!0,w=s(e,i,"plugins",L);if(U(e,i),o&&n.push(`--sourcemap${o===!0?"":`=${o}`}`),u&&n.push("--bundle"),p&&n.push("--splitting"),E&&n.push(`--metafile=${E}`),S&&n.push(`--outfile=${S}`),b&&n.push(`--outdir=${b}`),D&&n.push(`--outbase=${D}`),B&&n.push(`--platform=${B}`),W&&n.push(`--tsconfig=${W}`),H&&n.push(`--resolve-extensions=${H.join(",")}`),f&&n.push(`--public-path=${f}`),J&&n.push(`--main-fields=${J.join(",")}`),V)for(let h of V)n.push(`--external:${h}`);if($)for(let h of $)n.push(`--inject:${h}`);if(m)for(let h in m){if(h.indexOf("=")>=0)throw new Error(`Invalid extension: ${h}`);n.push(`--loader:${h}=${m[h]}`)}if(c)for(let h in c){if(h.indexOf("=")>=0)throw new Error(`Invalid extension: ${h}`);n.push(`--out-extension:${h}=${c[h]}`)}if(_)for(let h of _){if(h+="",h.startsWith("-"))throw new Error(`Invalid entry point: ${h}`);n.push(h)}if(k){let h=Object.create(null),j=s(k,h,"contents",g),d=s(k,h,"resolveDir",g),y=s(k,h,"sourcefile",g),F=s(k,h,"loader",g);U(k,h),y&&n.push(`--sourcefile=${y}`),F&&n.push(`--loader=${F}`),d&&(l=d+""),a=j?j+"":""}return[n,C,w,a,l,x]}function zt(e,t,r){let n=[],i=Object.create(null);se(n,e,i,t,r),He(n,e,i);let a=s(e,i,"sourcemap",be),l=s(e,i,"tsconfigRaw",qt),o=s(e,i,"sourcefile",g),u=s(e,i,"loader",g);return U(e,i),a&&n.push(`--sourcemap=${a===!0?"external":a}`),l&&n.push(`--tsconfig-raw=${typeof l=="string"?l:JSON.stringify(l)}`),o&&n.push(`--sourcefile=${o}`),u&&n.push(`--loader=${u}`),n}function ze(e){let t=new Map,r=new Map,n=new Map,i=0,a=!1,l=0,o=0,u=new Uint8Array(16*1024),p=0,E=m=>{let c=p+m.length;if(c>u.length){let $=new Uint8Array(c*2);$.set(u),u=$}u.set(m,p),p+=m.length;let f=0;for(;f+4<=p;){let $=We(u,f);if(f+4+$>p)break;f+=4,H(u.slice(f,f+$)),f+=$}f>0&&(u.set(u.slice(f)),p-=f)},S=()=>{a=!0;for(let m of t.values())m("The service was stopped",null);t.clear();for(let m of n.values())m.onWait("The service was stopped");n.clear()},b=(m,c)=>{if(a)return c("The service is no longer running",null);let f=l++;t.set(f,c),e.writeToStdin(Me({id:f,isRequest:!0,value:m}))},D=(m,c)=>{if(a)throw new Error("The service is no longer running");e.writeToStdin(Me({id:m,isRequest:!1,value:c}))},B=(m,c)=>Le(this,null,function*(){try{switch(c.command){case"resolve":{let f=r.get(c.key);D(m,yield f(c));break}case"load":{let f=r.get(c.key);D(m,yield f(c));break}case"serve-request":{let f=n.get(c.serveID);D(m,{}),f&&f.onRequest&&f.onRequest(c.args);break}case"serve-wait":{let f=n.get(c.serveID);D(m,{}),f&&f.onWait(c.error);break}default:throw new Error("Invalid command: "+c.command)}}catch(f){D(m,{errors:[yield ee(f,e)]})}}),W=!0,H=m=>{if(W){W=!1;let f=String.fromCharCode(...m);if(f!=="0.8.16")throw new Error(`Cannot start service: Host version "0.8.16" does not match binary version ${JSON.stringify(f)}`);return}let c=Ut(m);if(c.isRequest)B(c.id,c.value);else{let f=t.get(c.id);t.delete(c.id),c.value.error?f(c.value.error,{}):f(null,c.value)}},J=(m,c,f)=>{if(e.isSync)throw new Error("Cannot use plugins in synchronous API calls");let $={},_={},k=0,C=0;c.plugins=[];for(let x of m){let w=x.name,h=x.setup,j={name:w+"",onResolve:[],onLoad:[]};if(typeof w!="string"||w==="")throw new Error(`Plugin at index ${C} is missing a name`);if(typeof h!="function")throw new Error(`[${j.name}] Missing a setup function`);C++,h({onResolve(d,y){let F={},R=s(d,F,"filter",Ve),O=s(d,F,"namespace",g);if(U(d,F),R==null)throw new Error(`[${j.name}] "onResolve" is missing a filter`);let T=k++;$[T]=y,j.onResolve.push({id:T,filter:R.source,namespace:O||""})},onLoad(d,y){let F={},R=s(d,F,"filter",Ve),O=s(d,F,"namespace",g);if(U(d,F),R==null)throw new Error(`[${j.name}] "onLoad" is missing a filter`);let T=k++;_[T]=y,j.onLoad.push({id:T,filter:R.source,namespace:O||""})}}),c.plugins.push(j)}return r.set(f,x=>Le(this,null,function*(){switch(x.command){case"resolve":{let w={};for(let h of x.ids)try{let j=$[h],d=yield j({path:x.path,importer:x.importer,namespace:x.namespace,resolveDir:x.resolveDir});if(d!=null){if(typeof d!="object")throw new Error("Expected resolver plugin to return an object");let y={},F=s(d,y,"pluginName",g),R=s(d,y,"path",g),O=s(d,y,"namespace",g),T=s(d,y,"external",I),A=s(d,y,"errors",L),N=s(d,y,"warnings",L);U(d,y),w.id=h,F!=null&&(w.pluginName=F),R!=null&&(w.path=R),O!=null&&(w.namespace=O),T!=null&&(w.external=T),A!=null&&(w.errors=ue(A)),N!=null&&(w.warnings=ue(N));break}}catch(j){return{id:h,errors:[yield ee(j,e)]}}return w}case"load":{let w={};for(let h of x.ids)try{let j=_[h],d=yield j({path:x.path,namespace:x.namespace});if(d!=null){if(typeof d!="object")throw new Error("Expected loader plugin to return an object");let y={},F=s(d,y,"pluginName",g),R=s(d,y,"contents",Ht),O=s(d,y,"resolveDir",g),T=s(d,y,"loader",g),A=s(d,y,"errors",L),N=s(d,y,"warnings",L);U(d,y),w.id=h,F!=null&&(w.pluginName=F),R instanceof Uint8Array?w.contents=R:R!=null&&(w.contents=X(R)),O!=null&&(w.resolveDir=O),T!=null&&(w.loader=T),A!=null&&(w.errors=ue(A)),N!=null&&(w.warnings=ue(N));break}}catch(j){return{id:h,errors:[yield ee(j,e)]}}return w}default:throw new Error("Invalid command: "+x.command)}})),()=>r.delete(f)},V=(m,c)=>{let f={},$=s(m,f,"port",Y),_=s(m,f,"host",g),k=s(m,f,"onRequest",Mt),C=i++,x,w=new Promise((h,j)=>{x=d=>{n.delete(C),d!==null?j(new Error(d)):h()}});return c.serve={serveID:C},U(m,f),$!==void 0&&(c.serve.port=$),_!==void 0&&(c.serve.host=_),n.set(C,{onRequest:k,onWait:x}),{wait:w,stop(){b({command:"serve-stop",serveID:C},()=>{})}}};return{readFromStdout:E,afterClose:S,service:{buildOrServe(m,c,f,$){let _="info";try{let k=o++,[C,x,w,h,j,d]=Jt(c,f,_),y={command:"build",key:k,flags:C,write:x,stdin:h,resolveDir:j,incremental:d},F=m&&V(m,y),R=w&&w.length>0&&J(w,y,k),O,T=(A,N)=>{let Z=A.errors,ie=A.warnings;if(Z.length>0)return N(Je("Build failed",Z,ie),null);let we={warnings:ie};if(A.outputFiles&&(we.outputFiles=A.outputFiles.map(Kt)),A.rebuildID!==void 0){if(!O){let Ae=!1;O=()=>new Promise((xt,Et)=>{if(Ae||a)throw new Error("Cannot rebuild");b({command:"rebuild",rebuildID:A.rebuildID},(_e,St)=>{if(_e)return N(new Error(_e),null);T(St,(Ce,jt)=>{Ce?Et(Ce):xt(jt)})})}),O.dispose=()=>{Ae=!0,R&&R(),b({command:"rebuild-dispose",rebuildID:A.rebuildID},()=>{})}}we.rebuild=O}return N(null,we)};if(d&&e.isSync)throw new Error('Cannot use "incremental" with a synchronous build');b(y,(A,N)=>{if(A)return $(new Error(A),null);if(F){let Z=N,ie={port:Z.port,host:Z.host,wait:F.wait,stop:F.stop};return $(null,ie)}return R&&!d&&R(),T(N,$)})}catch(k){let C=[];try{se(C,c,{},f,_)}catch(x){}b({command:"error",flags:C,error:ee(k,e)},()=>{$(k,null)})}},transform(m,c,f,$,_){let k="silent",C=x=>{try{let w=zt(c,f,k),h={command:"transform",flags:w,inputFS:x!==null,input:x!==null?x:m+""};b(h,(j,d)=>{if(j)return _(new Error(j),null);let y=d.errors,F=d.warnings,R=1,O=()=>--R===0&&_(null,{warnings:F,code:d.code,map:d.map});if(y.length>0)return _(Je("Transform failed",y,F),null);d.codeFS&&(R++,$.readFile(d.code,(T,A)=>{T!==null?_(T,null):(d.code=A,O())})),d.mapFS&&(R++,$.readFile(d.map,(T,A)=>{T!==null?_(T,null):(d.map=A,O())})),O()})}catch(w){let h=[];try{se(h,c,{},f,k)}catch(j){}b({command:"error",flags:h,error:ee(w,e)},()=>{_(w,null)})}};if(typeof m=="string"&&m.length>1024*1024){let x=C;C=()=>$.writeFile(m,x)}C(null)}}}}function ee(e,t){let r="Internal error",n=null;try{r=(e&&e.message||e)+""}catch(i){}try{let i=e.stack+"",a=i.split(`
`,3),l="    at ";if(t.readFileSync&&!a[0].startsWith(l)&&a[1].startsWith(l)){let o=a[1].slice(l.length);for(;;){let u=/^\S+ \((.*)\)$/.exec(o);if(u){o=u[1];continue}if(u=/^eval at \S+ \((.*)\)(?:, \S+:\d+:\d+)?$/.exec(o),u){o=u[1];continue}if(u=/^(\S+):(\d+):(\d+)$/.exec(o),u){let p=t.readFileSync(u[1],"utf8"),E=p.split(/\r\n|\r|\n|\u2028|\u2029/)[+u[2]-1]||"";n={file:u[1],namespace:"file",line:+u[2],column:+u[3]-1,length:0,lineText:E+`
`+a.slice(1).join(`
`)}}break}}}catch(i){}return{text:r,location:n}}function Je(e,t,r){let n=5,i=t.length<1?"":` with ${t.length} error${t.length<2?"":"s"}:`+t.slice(0,n+1).map((l,o)=>{if(o===n)return`
...`;if(!l.location)return`
error: ${l.text}`;let{file:u,line:p,column:E}=l.location;return`
${u}:${p}:${E}: error: ${l.text}`}).join(""),a=new Error(`${e}${i}`);return a.errors=t,a.warnings=r,a}function ue(e){let t=[];for(let r of e){let n={},i=s(r,n,"text",g),a=s(r,n,"location",Wt);U(r,n);let l=null;if(a!=null){let o={},u=s(a,o,"file",g),p=s(a,o,"namespace",g),E=s(a,o,"line",Y),S=s(a,o,"column",Y),b=s(a,o,"length",Y),D=s(a,o,"lineText",g);U(a,o),l={file:u||"",namespace:p||"",line:E||0,column:S||0,length:b||0,lineText:D||""}}t.push({text:i||"",location:l})}return t}function Kt({path:e,contents:t}){let r=null;return{path:e,contents:t,get text(){return r===null&&(r=Q(t)),r}}}var Ke=require("child_process"),Zt=require("crypto"),ce=require("path"),q=require("fs"),Gt=require("os"),Xt=require("tty"),Ze=()=>{if(process.platform==="win32")return[ce.join(__dirname,"..","esbuild.exe"),[]];let e=ce.join(__dirname,"esbuild");return q.existsSync(e)?[e,[]]:[ce.join(__dirname,"..","bin","esbuild"),[]]},te=()=>Xt.isatty(2),Ot="0.8.16",Pt=e=>oe().then(t=>t.build(e).then(r=>{if(r.rebuild){let n=r.rebuild.dispose;r.rebuild.dispose=()=>{n(),t.stop()}}else t.stop();return r},r=>{throw t.stop(),r})),Bt=(e,t)=>oe().then(r=>r.serve(e,t).then(n=>(n.wait.then(r.stop,r.stop),n),n=>{throw r.stop(),n})),Nt=(e,t)=>oe().then(r=>{let n=r.transform(e,t);return n.then(r.stop,r.stop),n}),It=e=>{let t;return Ge(r=>r.buildOrServe(null,e,te(),(n,i)=>{if(n)throw n;t=i})),t},Lt=(e,t)=>{let r;return Ge(n=>n.transform(e,t||{},te(),{readFile(i,a){try{let l=q.readFileSync(i,"utf8");try{q.unlinkSync(i)}catch(o){}a(null,l)}catch(l){a(l,null)}},writeFile(i,a){try{let l=Xe();q.writeFileSync(l,i),a(l)}catch(l){a(null)}}},(i,a)=>{if(i)throw i;r=a})),r},oe=e=>{if(e){if(e.wasmURL)throw new Error('The "wasmURL" option only works in the browser');if(e.worker)throw new Error('The "worker" option only works in the browser')}let[t,r]=Ze(),n=Ke.spawn(t,r.concat("--service=0.8.16"),{cwd:process.cwd(),windowsHide:!0,stdio:["pipe","pipe","inherit"]}),{readFromStdout:i,afterClose:a,service:l}=ze({writeToStdin(o){n.stdin.write(o)},readFileSync:q.readFileSync,isSync:!1});return n.stdout.on("data",i),n.stdout.on("end",a),Promise.resolve({build:o=>new Promise((u,p)=>l.buildOrServe(null,o,te(),(E,S)=>E?p(E):u(S))),serve:(o,u)=>{if(o===null||typeof o!="object")throw new Error("The first argument must be an object");return new Promise((p,E)=>l.buildOrServe(o,u,te(),(S,b)=>S?E(S):p(b)))},transform:(o,u)=>new Promise((p,E)=>l.transform(o,u||{},te(),{readFile(S,b){try{q.readFile(S,"utf8",(D,B)=>{try{q.unlink(S,()=>b(D,B))}catch(W){b(D,B)}})}catch(D){b(D,null)}},writeFile(S,b){try{let D=Xe();q.writeFile(D,S,B=>B!==null?b(null):b(D))}catch(D){b(null)}}},(S,b)=>S?E(S):p(b))),stop(){n.kill()}})},Ge=e=>{let[t,r]=Ze(),n=new Uint8Array,{readFromStdout:i,afterClose:a,service:l}=ze({writeToStdin(u){if(n.length!==0)throw new Error("Must run at most one command");n=u},isSync:!0});e(l);let o=Ke.execFileSync(t,r.concat("--service=0.8.16"),{cwd:process.cwd(),windowsHide:!0,input:n,maxBuffer:+process.env.ESBUILD_MAX_BUFFER||16*1024*1024});i(o),a()},Xe=()=>ce.join(Gt.tmpdir(),`esbuild-${Zt.randomBytes(32).toString("hex")}`)}),Se=le((xr,rt)=>{var de=require("fs"),nt=require("path"),Qt=require("os");function xe(e,t){return Object.prototype.toString.call(e)==="[object "+t+"]"}function Ee(e,t){try{return t(e)}catch(r){if(/^(ENOENT|EPERM|EACCES)$/.test(r.code))return r.code!=="ENOENT"&&console.warn("Warning: Cannot access %s",e),!1;throw r}}var Yt={nil:function(e){return e==null},array:function(e){return Array.isArray(e)},emptyObject:function(e){for(var t in e)return!1;return!0},buffer:function(e){return Buffer.isBuffer(e)},regExp:function(e){return xe(e,"RegExp")},string:function(e){return xe(e,"String")},func:function(e){return typeof e=="function"},number:function(e){return xe(e,"Number")},exists:function(e){return de.existsSync(e)},file:function(e){return Ee(e,function(t){return de.statSync(t).isFile()})},samePath:function(e,t){return nt.resolve(e)===nt.resolve(t)},directory:function(e){return Ee(e,function(t){return de.statSync(t).isDirectory()})},symbolicLink:function(e){return Ee(e,function(t){return de.lstatSync(t).isSymbolicLink()})},windows:function(){return Qt.platform()==="win32"}};rt.exports=Yt}),st=le((Er,it)=>{var re=require("fs"),lt=require("os"),je=require("path"),he=Se(),ne,er=lt.tmpdir&&lt.tmpdir()||process.env.TMPDIR||process.env.TEMP||process.cwd();function ot(){this.stack=[]}ot.prototype={create:function(e,t){var r=je.join(t,"node-watch-"+Math.random().toString(16).substr(2));return this.stack.push({name:r,type:e}),r},write:function(){for(var e=0;e<arguments.length;++e)re.writeFileSync(arguments[e]," ")},mkdir:function(){for(var e=0;e<arguments.length;++e)re.mkdirSync(arguments[e])},cleanup:function(e){try{for(var t;t=this.stack.pop();){var r=t.type,n=t.name;r==="file"&&he.file(n)?re.unlinkSync(n):r==="dir"&&he.directory(n)&&re.rmdirSync(n)}}finally{he.func(e)&&e()}}};var at=!1;it.exports=function e(t){if(!he.func(t))return!1;if(ne!==void 0)return t(ne);if(!at)at=!0;else return setTimeout(function(){e(t)},300);var r=new ot,n=r.create("dir",er),i=r.create("dir",n),a=r.create("file",i);r.mkdir(n,i);var l={recursive:!0},o;try{o=re.watch(n,l)}catch(p){if(p.code=="ERR_FEATURE_UNAVAILABLE_ON_PLATFORM")return t(ne=!1);throw p}if(!o)return!1;var u=setTimeout(function(){o.close(),r.cleanup(function(){t(ne=!1)})},200);o.on("change",function(p,E){je.basename(a)===je.basename(E)&&(o.close(),clearTimeout(u),r.cleanup(function(){t(ne=!0)}))}),r.write(a)}}),vt=le((Sr,$e)=>{var Fe=require("fs"),K=require("path"),ut=require("util"),ct=require("events"),ft=st(),v=Se(),tr="update",dt="remove",me=Symbol("skip");function rr(e){return e.some(function(t,r,n){return n.indexOf(t)!==r})}function De(e){return e.filter(function(t,r,n){return n.indexOf(t)===r})}function nr(e){return e.reduce(function(t,r){return t.concat(r)},[])}function ir(e){if(e&&e!=="buffer"&&!Buffer.isEncoding(e))throw new Error("Unknown encoding: "+e)}function lr(e){return function(t,r){if(v.func(e)){var n=e(t,me);n&&n!==me&&r()}else v.regExp(e)?e.test(t)&&r():r()}}function or(e){return e.map(function(t){return v.exists(t)?[tr,t]:[dt,t]})}function ar(e){var t=De(e),r=/~$|^\.#|^##$/g,n=e.some(function(l){return r.test(l)});if(n){var i=rr(e.map(function(l){return l.replace(r,"")}));i&&(t=t.filter(function(l){return v.exists(l)}))}if(v.windows()){var a=t.map(function(l){return K.parse(l).dir});t=t.filter(function(l){return v.exists(l)?!a.some(function(o){return v.samePath(l,o)}):!0})}return or(t)}function sr(e,t){var r,n=[],i=e.options.encoding,a=e.options.delay;v.number(a)||(a=200);function l(){ar(n).forEach(function(o){o[1]=Buffer.from(o[1]),i!=="buffer"&&(o[1]=o[1].toString(i)),t.apply(null,o)}),r=null,n=[]}return function(o,u){n.push(u),r||(r=setTimeout(l,a))}}function ht(){var e={};return function(t){return function(r,n){e[r+n]=[r,n],setTimeout(function(){Object.keys(e).forEach(function(i){t.apply(null,e[i])}),e={}})}}}function mt(e,t,r=function(){}){v.directory(e)?Fe.readdir(e,function(n,i){if(n)if(/^(EPERM|EACCES)$/.test(n.code))console.warn("Warning: Cannot access %s.",e);else throw n;else i.forEach(function(a){var l=K.join(e,a);v.directory(l)&&t(l)}),r()}):r()}function ur(e){var t=0;return function(){return t++,function(){t--,t===0&&e()}}}function cr(){return function(){}}function pt(e,t){return!v.func(t)||t(e,me)!==me}var wt=ut.deprecate(function(){},"(node-watch) First param in callback function  is replaced with event name since 0.5.0, use  `(evt, filename) => {}` if you want to get the filename");function M(){ct.EventEmitter.call(this),this.watchers={},this._isReady=!1,this._isClosed=!1}ut.inherits(M,ct.EventEmitter);M.prototype.expose=function(){var e={},t=this,r=["on","emit","once","close","isClosed","listeners","setMaxListeners","getMaxListeners","getWatchedPaths"];return r.forEach(function(n){e[n]=function(){return t[n].apply(t,arguments)}}),e};M.prototype.isClosed=function(){return this._isClosed};M.prototype.close=function(e){var t=this;if(e){var r=this.watchers[e];r&&r.close&&(r.close(),delete t.watchers[e]),mt(e,function(n){t.close(n)})}else Object.keys(t.watchers).forEach(function(n){var i=t.watchers[n];i&&i.close&&i.close()}),this.watchers={};v.emptyObject(t.watchers)&&(this._isClosed=!0,process.nextTick(gt,this))};M.prototype.getWatchedPaths=function(e){if(v.func(e)){var t=this;t._isReady?e(Object.keys(t.watchers)):t.on("ready",function(){e(Object.keys(t.watchers))})}};function Re(e){e._isReady||(e._isReady=!0,process.nextTick(function(){e.emit("ready")}))}function gt(e){e.emit("close")}M.prototype.add=function(e,t){var r=this;t=t||{fpath:""};var n=K.resolve(t.fpath);this.watchers[n]=e;var i=function(l,o){if(r.isClosed())return;var u=o;v.nil(u)&&(u=""),u=K.join(t.fpath,u),t.options.recursive&&ft(function(p){if(!p){var E=K.resolve(u);if(!v.exists(u))r.close(E);else{var S=v.directory(u)&&!r.watchers[E]&&pt(u,t.options.filter);S&&r.watchDirectory(u,t.options)}}}),a(l,u)},a=sr(t,function(l,o){if(t.compareName)t.compareName(o)&&r.emit("change",l,o);else{var u=lr(t.options.filter);u(o,function(){r.flag?r.flag="":r.emit("change",l,o)})}});e.on("error",function(l){if(r.isClosed())return;v.windows()&&l.code==="EPERM"?(e.emit("change",dt,t.fpath&&""),r.flag="windows-error",r.close(n)):r.emit("error",l)}),e.on("change",i)};M.prototype.watchFile=function(e,t,r){var n=K.join(e,"../"),i=Object.assign({},t,{filter:null,encoding:"utf8"});delete i.recursive;var a=Fe.watch(n,i);this.add(a,{type:"file",fpath:n,options:Object.assign({},i,{encoding:t.encoding}),compareName:function(l){return v.samePath(l,e)}}),v.func(r)&&(r.length===1&&wt(),this.on("change",r))};M.prototype.watchDirectory=function(e,t,r,n=cr){var i=this,a=n();ft(function(l){t.recursive=!!t.recursive;var o=Object.assign({},t,{encoding:"utf8"});l||delete o.recursive;var u=Fe.watch(e,o);i.add(u,{type:"dir",fpath:e,options:t}),v.func(r)&&(r.length===1&&wt(),i.on("change",r)),t.recursive&&!l&&mt(e,function(p){pt(p,t.filter)&&i.watchDirectory(p,t,null,n)},n()),a()})};function fr(e){var t=new M,r=ht(),n=e.length;return e.forEach(function(i){i.on("change",r(function(a,l){t.emit("change",a,l)})),i.on("error",function(a){t.emit("error",a)}),i.on("ready",function(){--n||Re(t)})}),t.close=function(){e.forEach(function(i){i.close()}),process.nextTick(gt,t)},t.getWatchedPaths=function(i){if(v.func(i)){var a=e.map(function(l){return new Promise(function(o){l.getWatchedPaths(o)})});Promise.all(a).then(function(l){var o=De(nr(l));i(o)})}},t.expose()}function pe(e,t,r){var n=new M;if(v.buffer(e)&&(e=e.toString()),!v.array(e)&&!v.exists(e)&&n.emit("error",new Error(e+" does not exist.")),v.string(t)&&(t={encoding:t}),v.func(t)&&(r=t,t={}),arguments.length<2&&(t={}),t.encoding?ir(t.encoding):t.encoding="utf8",v.array(e)){if(e.length===1)return pe(e[0],t,r);var i=ht();return fr(De(e).map(function(l){var o=pe(l,t);return v.func(r)&&o.on("change",i(r)),o}))}if(v.file(e))n.watchFile(e,t,r),Re(n);else if(v.directory(e)){var a=ur(function(){Re(n)});n.watchDirectory(e,t,r,a)}return n.expose()}$e.exports=pe;$e.exports.default=pe}),ve=z(require("fs")),Pe=z(require("path")),Oe={name:"project",source:"src/index.js",platform:"node",outputDir:"dist",bundle:!0,minify:!0,sourcemap:!0,target:[],watchDir:"src",esbuild:{}},P={config:[],watchDirs:[]};async function Be(){let e=[],t=Pe.default.resolve(process.cwd(),"esbundle.json");try{if(ve.default.existsSync(t)){let r=JSON.parse(ve.default.readFileSync(t));Array.isArray(r)?e=[...r]:e.push(r)}else console.warn("No esbundle.json file found, using defaults")}catch(r){console.warn("Error in esbundle.json file, using defaults",r)}e.forEach(r=>P.config.push(G(G({},Oe),r))),P.config.forEach(r=>{P.watchDirs.includes(r.watchDir)||P.watchDirs.push(r.watchDir)}),console.log("config:",P.config)}var Ye=z(require("path")),et=z(Qe());async function fe(){let e=P.config.reduce((t,r)=>r.types&&r.types.length?[...t,...r.types.map((n,i)=>tt(r,i===0?"":`.${n}`))]:[...t,tt(r)],[]);return Promise.all(e)}function tt(e,t=""){return et.default.build(G({entryPoints:[e.source],outfile:Ye.default.join(e.outputDir,`${e.name}${t}.js`),bundle:!0,platform:e.platform,minify:e.minify,sourcemap:e.sourcemap,target:e.target.length?e.target:void 0},e.esbuild))}var ke=z(require("path")),Te=z(vt());async function yt(){return Te.default(ke.default.join(process.cwd(),"esbundle.json"),{},()=>"restart"),P.watchDirs.map(async e=>{let t=ke.default.resolve(process.cwd(),e);return Te.default(t,{recursive:!0},async(r,n)=>(console.log("File change:",n,r),await fe()))})}process.argv.includes("--dev")?P.mode="dev":P.mode="build";async function bt(){console.log(`
Building..
`),await Be();let e=await fe();if(console.log(e),console.log(`
All built
`),P.mode==="dev"){let t=await yt();t.then(console.log),console.log("WATCH",t),t==="restart"&&bt()}}bt();
